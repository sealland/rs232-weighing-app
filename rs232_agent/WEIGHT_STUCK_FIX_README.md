# р╕Бр╕▓р╕гр╣Бр╕Бр╣Йр╣Др╕Вр╕Ыр╕▒р╕Нр╕лр╕▓р╕Щр╣Йр╕│р╕лр╕Щр╕▒р╕Бр╕Др╣Йр╕▓р╕Зр╕лр╕ер╕▒р╕Зр╕Ир╕▓р╕Б WebSocket Reconnect

## ЁЯРЫ р╕Ыр╕▒р╕Нр╕лр╕▓р╕Чр╕╡р╣Ир╕Юр╕Ъ

р╣Ар╕бр╕╖р╣Ир╕н WebSocket connection р╕лр╕ер╕╕р╕Фр╣Бр╕ер╕░ reconnect р╣Бр╕ер╣Йр╕з р╕Щр╣Йр╕│р╕лр╕Щр╕▒р╕Бр╕Ир╕░р╕Др╣Йр╕▓р╕Зр╕Чр╕╡р╣И 0 р╕лр╕гр╕╖р╕нр╕Др╣Ир╕▓р╕кр╕╕р╕Фр╕Чр╣Йр╕▓р╕вр╕Чр╕╡р╣Ир╕кр╣Ир╕Зр╣Др╕Ы

## ЁЯФз р╕Бр╕▓р╕гр╣Бр╕Бр╣Йр╣Др╕В

### 1. р╕Бр╕▓р╕гр╕ер╣Йр╕▓р╕З Buffer р╣Ар╕Бр╣Ир╕▓р╣Ар╕бр╕╖р╣Ир╕н Reconnect

р╣Ар╕Юр╕┤р╣Ир╕бр╕Бр╕▓р╕гр╕ер╣Йр╕▓р╕З buffer р╣Ар╕Бр╣Ир╕▓р╣Ар╕бр╕╖р╣Ир╕н reconnect р╣Ар╕Юр╕╖р╣Ир╕нр╣Др╕бр╣Ир╣Гр╕лр╣Йр╕кр╣Ир╕Зр╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Ар╕Бр╣Ир╕▓:

```python
# р╕ер╣Йр╕▓р╕З buffer р╣Ар╕Бр╣Ир╕▓р╣Ар╕бр╕╖р╣Ир╕н reconnect р╣Ар╕Юр╕╖р╣Ир╕нр╣Др╕бр╣Ир╣Гр╕лр╣Йр╕кр╣Ир╕Зр╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Ар╕Бр╣Ир╕▓
if len(self.read_buffer) > 0:
    self.log_message("Clearing old buffer after reconnect")
    self.read_buffer = b''
```

### 2. р╕Бр╕▓р╕гр╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕Щр╣Йр╕│р╕лр╕Щр╕▒р╕Б 0

р╣Ар╕Юр╕┤р╣Ир╕бр╕Бр╕▓р╕гр╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕Щр╣Йр╕│р╕лр╕Щр╕▒р╕Б 0 р╣Бр╕ер╕░р╣Др╕бр╣Ир╕кр╣Ир╕Зр╕Лр╣Йр╕│:

```python
# р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕зр╣Ир╕▓р╕Щр╣Йр╕│р╕лр╕Щр╕▒р╕Бр╣Ар╕Ыр╣Зр╕Щ 0 р╕лр╕гр╕╖р╕нр╣Др╕бр╣И р╣Бр╕ер╕░р╣Др╕бр╣Ир╕кр╣Ир╕Зр╕Лр╣Йр╕│
if weight == "0" or weight == "0.0":
    # р╕Цр╣Йр╕▓р╕Щр╣Йр╕│р╕лр╕Щр╕▒р╕Бр╣Ар╕Ыр╣Зр╕Щ 0 р╣Гр╕лр╣Йр╕гр╕нр╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Гр╕лр╕бр╣И
    await asyncio.sleep(0.5)
    continue
```

### 3. р╕Бр╕▓р╕гр╕Ыр╕гр╕▒р╕Ър╕Ыр╕гр╕╕р╕Зр╕Бр╕▓р╕гр╕Ыр╕гр╕░р╕бр╕зр╕ер╕Ьр╕ер╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Гр╕лр╕бр╣И

р╕Ыр╕гр╕▒р╕Ър╕Ыр╕гр╕╕р╕Зр╕Бр╕▓р╕гр╕Ыр╕гр╕░р╕бр╕зр╕ер╕Ьр╕ер╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Гр╕лр╕бр╣Ир╣Ар╕Юр╕╖р╣Ир╕нр╣Др╕бр╣Ир╣Гр╕лр╣Йр╕кр╣Ир╕Зр╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Ар╕Бр╣Ир╕▓р╕Чр╕╡р╣Ир╣Ар╕Ыр╣Зр╕Щ 0:

```python
# р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Гр╕лр╕бр╣И
for line in lines:
    line = line.strip()
    if line:
        try:
            parsed_value = self.parse_scale_data(line)
            if parsed_value != "N/A":
                # р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕зр╣Ир╕▓р╕Щр╣Йр╕│р╕лр╕Щр╕▒р╕Бр╣Ар╕Ыр╣Зр╕Щ 0 р╕лр╕гр╕╖р╕нр╣Др╕бр╣И
                if parsed_value != "0" and parsed_value != "0.0":
                    self.last_weight = parsed_value
                    self.weight_label.config(text=f"тЪЦя╕П Weight: {parsed_value}")
                    self.log_message(f"New weight from buffer: {parsed_value}")
        except Exception as e:
            continue
```

### 4. р╕Бр╕▓р╕гр╕Ыр╕гр╕▒р╕Ър╕Ыр╕гр╕╕р╕Зр╕Бр╕▓р╕гр╕Ир╕▒р╕Фр╕Бр╕▓р╕г Buffer

- **р╕ер╣Йр╕▓р╕З buffer р╣Ар╕Бр╣Ир╕▓** р╣Ар╕бр╕╖р╣Ир╕н reconnect
- **р╣Др╕бр╣Ир╕кр╣Ир╕Зр╕Щр╣Йр╕│р╕лр╕Щр╕▒р╕Б 0** р╕Лр╣Йр╕│р╣Ж
- **р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Гр╕лр╕бр╣И** р╕Бр╣Ир╕нр╕Щр╕нр╕▒р╕Ыр╣Ар╕Фр╕Хр╕Щр╣Йр╕│р╕лр╕Щр╕▒р╕Б

## ЁЯУК р╕Ьр╕ер╕ер╕▒р╕Юр╕Шр╣М

р╕лр╕ер╕▒р╕Зр╕Ир╕▓р╕Бр╣Бр╕Бр╣Йр╣Др╕Вр╣Бр╕ер╣Йр╕з:

1. **р╣Др╕бр╣Ир╕бр╕╡р╕Бр╕▓р╕гр╕кр╣Ир╕Зр╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Ар╕Бр╣Ир╕▓** - р╕ер╣Йр╕▓р╕З buffer р╣Ар╕бр╕╖р╣Ир╕н reconnect
2. **р╣Др╕бр╣Ир╕кр╣Ир╕Зр╕Щр╣Йр╕│р╕лр╕Щр╕▒р╕Б 0 р╕Лр╣Йр╕│** - р╕гр╕нр╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Гр╕лр╕бр╣Ир╣Бр╕Чр╕Щ
3. **р╕Щр╣Йр╕│р╕лр╕Щр╕▒р╕Бр╕нр╕▒р╕Ыр╣Ар╕Фр╕Хр╕Цр╕╣р╕Бр╕Хр╣Йр╕нр╕З** - р╕лр╕ер╕▒р╕Зр╕Ир╕▓р╕Б reconnect
4. **р╕Бр╕▓р╕гр╕Чр╕│р╕Зр╕▓р╕Щр╣Ар╕кр╕Цр╕╡р╕вр╕г** - р╣Др╕бр╣Ир╕Др╣Йр╕▓р╕Зр╕нр╕╡р╕Бр╕Хр╣Ир╕нр╣Др╕Ы

## ЁЯФН р╕Бр╕▓р╕гр╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ

р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ log р╣Ар╕Юр╕╖р╣Ир╕нр╕Фр╕╣р╕Бр╕▓р╕гр╕Чр╕│р╕Зр╕▓р╕Щ:

- `"Clearing old buffer after reconnect"` - р╕ер╣Йр╕▓р╕З buffer р╣Ар╕Бр╣Ир╕▓
- `"New weight from buffer: X.X"` - р╕Щр╣Йр╕│р╕лр╕Щр╕▒р╕Бр╣Гр╕лр╕бр╣Ир╕Ир╕▓р╕Б buffer
- `"New weight from timeout read: X.X"` - р╕Щр╣Йр╕│р╕лр╕Щр╕▒р╕Бр╣Гр╕лр╕бр╣Ир╕Ир╕▓р╕Б timeout read
- `"Updated weight after buffer trim: X.X"` - р╕Щр╣Йр╕│р╕лр╕Щр╕▒р╕Бр╕нр╕▒р╕Ыр╣Ар╕Фр╕Хр╕лр╕ер╕▒р╕З trim

## ЁЯТб р╕Вр╣Йр╕нр╣Бр╕Щр╕░р╕Щр╕│

1. **р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ WebSocket URL** - р╣Гр╕лр╣Йр╕Цр╕╣р╕Бр╕Хр╣Йр╕нр╕З
2. **р╕Ыр╕гр╕▒р╕Ъ timeout** - р╕Хр╕▓р╕бр╕Др╕зр╕▓р╕бр╕Хр╣Йр╕нр╕Зр╕Бр╕▓р╕г
3. **р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ sensitivity** - р╣Гр╕лр╣Йр╣Ар╕лр╕бр╕▓р╕░р╕кр╕б
4. **р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ pattern** - р╣Гр╕лр╣Йр╕Хр╕гр╕Зр╕Бр╕▒р╕Ър╕Вр╣Йр╕нр╕бр╕╣р╕е

## ЁЯЪи р╕лр╕бр╕▓р╕вр╣Ар╕лр╕Хр╕╕

- р╕Бр╕▓р╕гр╕ер╣Йр╕▓р╕З buffer р╕нр╕▓р╕Ир╕Чр╕│р╣Гр╕лр╣Йр╕кр╕╣р╕Нр╣Ар╕кр╕╡р╕вр╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Ър╕▓р╕Зр╕кр╣Ир╕зр╕Щ р╣Бр╕Хр╣Ир╕Ир╕░р╕Ыр╣Йр╕нр╕Зр╕Бр╕▒р╕Щр╕Бр╕▓р╕гр╕кр╣Ир╕Зр╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Ар╕Бр╣Ир╕▓
- р╕Щр╣Йр╕│р╕лр╕Щр╕▒р╕Б 0 р╕Ир╕░р╣Др╕бр╣Ир╕Цр╕╣р╕Бр╕кр╣Ир╕Зр╕Лр╣Йр╕│ р╣Ар╕Юр╕╖р╣Ир╕нр╕ер╕Фр╕Бр╕▓р╕гр╕гр╕Ър╕Бр╕зр╕Щ
- р╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Гр╕лр╕бр╣Ир╕Ир╕░р╕Цр╕╣р╕Бр╕Ыр╕гр╕░р╕бр╕зр╕ер╕Ьр╕ер╕Чр╕▒р╕Щр╕Чр╕╡р╣Ар╕бр╕╖р╣Ир╕нр╣Др╕Фр╣Йр╕гр╕▒р╕Ъ
