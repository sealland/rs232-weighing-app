================================================================================
                    RS232 WEIGHING SYSTEM - คู่มือการติดตั้ง
================================================================================

📋 ระบบชั่งน้ำหนักผ่าน RS232 ที่เชื่อมต่อกับ Web Interface
   สำหรับการจัดการข้อมูลการชั่งน้ำหนักแบบ Real-time

================================================================================
📦 ไฟล์ที่ต้องใช้สำหรับการติดตั้ง
================================================================================

1. ไฟล์ Executable:
   - rs232_client_gui.exe (สำหรับเครื่อง Client ที่ต่อตาชั่ง)
   - agent.exe (สำหรับเครื่อง Server)

2. ไฟล์ Web Application:
   - backend/ (โฟลเดอร์ Backend API)
   - frontend/ (โฟลเดอร์ Frontend Web App)

================================================================================
��️ ขั้นตอนการติดตั้ง SERVER (เครื่องหลัก)
================================================================================

ขั้นตอนที่ 1: เตรียมระบบ
   - ติดตั้ง Python 3.8+ 
   - ติดตั้ง Node.js 16+
   - เปิด Command Prompt หรือ PowerShell แบบ Administrator

ขั้นตอนที่ 2: รัน Backend
   cd backend
   pip install -r requirements.txt
   python main.py
   
   Backend จะรันที่: http://localhost:8000

ขั้นตอนที่ 3: รัน Agent Server
   cd rs232_agent
   pip install -r requirements.txt
   python agent.py
   
   Agent จะรันที่: ws://localhost:8765

ขั้นตอนที่ 4: รัน Frontend
   cd frontend
   npm install
   npm run dev
   
   Frontend จะรันที่: http://localhost:5173

================================================================================
💻 ขั้นตอนการติดตั้ง CLIENT (เครื่องที่ต่อตาชั่ง)
================================================================================

ขั้นตอนที่ 1: เตรียมไฟล์
   - นำไฟล์ rs232_client_gui.exe ไปยังเครื่อง Client
   - ตรวจสอบว่าเครื่องต่อตาชั่ง RS232 แล้ว

ขั้นตอนที่ 2: ตั้งค่าเริ่มต้น
   - ดับเบิลคลิก rs232_client_gui.exe
   - หากขึ้น Permission Error ให้คลิกขวา → Run as administrator

ขั้นตอนที่ 3: ตั้งค่า Config
   - เลือก Port ที่ต่อตาชั่ง (COM1, COM2, etc.)
   - เลือก Baud Rate ตามตาชั่ง (9600, 19200, etc.)
   - เลือก Scale Pattern ตามตาชั่ง
   - เลือก Branch ที่ต้องการ
   - แก้ไข Server URL เป็น IP ของเครื่อง Server
   - กด Save เพื่อบันทึกการตั้งค่า

ขั้นตอนที่ 4: ทดสอบการเชื่อมต่อ
   - กด Test เพื่อทดสอบ Serial Connection
   - หากสำเร็จจะแสดง "Serial connection test successful!"
   - กด Start เพื่อเริ่มการทำงาน

================================================================================
🌐 การใช้งาน Web Interface
================================================================================

1. เปิดเว็บเบราว์เซอร์
2. เข้าไปที่: http://localhost:5173
3. สร้าง Ticket ตามปกติ
4. ข้อมูลจากตาชั่งจะปรากฏอัตโนมัติ

================================================================================
⚙️ การตั้งค่า Network
================================================================================

หาก Client และ Server อยู่คนละเครื่อง:

1. แก้ไข IP ใน rs232_client_gui.exe:
   - เปลี่ยน Server URL จาก localhost เป็น IP ของ Server
   - ตัวอย่าง: ws://192.168.1.100:8765

2. เปิด Firewall Ports:
   - Port 8765 (WebSocket Agent)
   - Port 8000 (Backend API)
   - Port 5173 (Frontend)

3. ตรวจสอบ Network:
   - Client ต้อง Ping ไป Server ได้
   - Server ต้องเปิดใช้งานอยู่

================================================================================
🔧 การแก้ไขปัญหา
================================================================================

ปัญหา: "Window cannot access the specified device"
วิธีแก้:
1. คลิกขวาไฟล์ .exe → Run as administrator
2. ปิด Antivirus ชั่วคราว
3. Add Exception ใน Antivirus
4. ตรวจสอบ Windows Defender

ปัญหา: Serial Connection Failed
วิธีแก้:
1. ตรวจสอบ Port ใน Device Manager
2. ตรวจสอบ Baud Rate ตามตาชั่ง
3. เปลี่ยน USB to Serial adapter
4. ตรวจสอบ Driver

ปัญหา: Cannot connect to Server
วิธีแก้:
1. ตรวจสอบ IP Address
2. ตรวจสอบ Firewall
3. ตรวจสอบว่า Server รันอยู่
4. ตรวจสอบ Network Connection

ปัญหา: No data from scale
วิธีแก้:
1. ตรวจสอบ Scale Pattern
2. ตรวจสอบการเชื่อมต่อ RS232
3. ทดสอบด้วย Test Button
4. ตรวจสอบ Log ใน GUI

================================================================================
📁 โครงสร้างไฟล์
================================================================================

rs232-weighing-app/
├── backend/                 # Backend API (FastAPI)
│   ├── main.py
│   ├── crud.py
│   ├── models.py
│   └── requirements.txt
├── frontend/               # Frontend Web App (Vue.js)
│   ├── src/
│   ├── package.json
│   └── vite.config.js
├── rs232_agent/           # RS232 Agent & Client
│   ├── agent.py
│   ├── rs232_client_gui.py
│   └── requirements.txt
├── rs232_client_gui.exe   # Client Executable
├── agent.exe              # Agent Executable
└── README.txt            # คู่มือนี้

================================================================================
🎯 สถาปัตยกรรมระบบ
================================================================================

┌─────────────────┐    WebSocket    ┌─────────────────┐    WebSocket    ┌─────────────────┐
│   Scale Client  │ ──────────────► │   Agent Server  │ ──────────────► │  Web Interface  │
│  (rs232_client) │                 │    (agent.py)   │                 │   (Frontend)    │
│                 │                 │                 │                 │                 │
│ • อ่าน RS232     │                 │ • รับข้อมูล      │                 │ • แสดงผล        │
│ • Parse ข้อมูล    │                 │ • เก็บข้อมูล      │                 │ • สร้าง Ticket  │
│ • ส่งไป Agent    │                 │ • Broadcast     │                 │ • บันทึก DB     │
└─────────────────┘                 └─────────────────┘                 └─────────────────┘

================================================================================
📞 การติดต่อและ Support
================================================================================

หากมีปัญหาในการติดตั้งหรือใช้งาน:
1. ตรวจสอบ Log ใน rs232_client_gui.exe
2. ตรวจสอบ Console ของ Backend และ Agent
3. ตรวจสอบ Network Connection
4. ตรวจสอบ Hardware Connection

================================================================================
📝 หมายเหตุ
================================================================================

- ระบบรองรับการใช้งานหลาย Client พร้อมกัน
- ข้อมูลจะถูกเก็บใน Database แบบ Real-time
- สามารถเลือก Branch และ Scale Pattern ได้
- รองรับการตั้งค่า Config และบันทึกการตั้งค่า

================================================================================
✅ การตรวจสอบการติดตั้งสำเร็จ
================================================================================

1. ✅ rs232_client_gui.exe รันได้และเชื่อมต่อ Serial ได้
2. ✅ agent.exe รันได้และแสดง "Agent server started"
3. ✅ Backend รันได้ที่ http://localhost:8000
4. ✅ Frontend รันได้ที่ http://localhost:5173
5. ✅ ข้อมูลจากตาชั่งปรากฏใน Web Interface

หากผ่านทุกข้อ = การติดตั้งสำเร็จ! 🎉

================================================================================